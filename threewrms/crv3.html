<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>wrms</title>
    <style>
			body { margin: 0; color: blue; }
			canvas { display: block; }
		</style>
	</head>
	<body>
		<script src="./threepeat/three/build/three.min.js"></script>
		<script src="./threepeat/tween.umd.js"></script>
		<script type="module" src="./threepeat/threepeat.js"></script>
		<script type="module">
			import * as THREE from './threepeat/three/build/three.module.js';
			import { OrbitControls } from
				'./threepeat/three/examples/jsm/controls/OrbitControls.js';
		    import { Wrm, loadmodel, makemodel, makecrv, Seq } from './wrms.js';
		    import { threepeat } from './threepeat/threepeat.js';
			import { Curves } from
			'./threepeat/three/examples/jsm/curves/CurveExtras.js';

		    var w = window;

		    w.ll = 20;

			var imgload = new THREE.TextureLoader();
			var orbits = [
			  {
			    // "target": {
			    //   "x": 0,
			    //   "y": 0,
			    //   "z": 0
			    // },
			    // "position": {
			      "x": -61.6053626894785,
			      "y": -20.871743790295138,
			      "z": 65.35511893835441
			    // },
			    // "zoom": 1
			  },
			  {
			    // "target": {
			    //   "x": 0,
			    //   "y": 0,
			    //   "z": 0
			    // },
			    // "position": {
			      "x": 81.27121621801363,
			      "y": 0.6552150684068174,
			      "z": -17.87758044487992
			    // },
			    // "zoom": 1
			  },
			  {
			    // "target": {
			    //   "x": 0,
			    //   "y": 0,
			    //   "z": 0
			    // },
			    // "position": {
			      "x": -76.74118246853925,
			      "y": -25.153948986180325,
			      "z": 20.077787194687897
			    // },
			    // "zoom": 1
			  },
			  {
			    // "target": {
			    //   "x": 0,
			    //   "y": 0,
			    //   "z": 0
			    // },
			    // "position": {
			      "x": -92.26396654180213,
			      "y": 50.85912736190672,
			      "z": 249.4118524488325
			    // },
			    // "zoom": 1
			  },
			  {
			    // "target": {
			    //   "x": 0,
			    //   "y": 0,
			    //   "z": 0
			    // },
			    // "position": {
			      "x": 229.37507070182608,
			      "y": 130.73360067385408,
			      "z": 60.01137471664247
			    // },
			    // "zoom": 1
			  }
		  	];

			imgload.load(
				'img/IMG_0618.jpeg',
				// 'img/100_3995.JPG',
				// 'img/Screen Shot 2019-09-04 at 4.25.54 PM.png',
				// 'img/Screen Shot 2019-06-28 at 3.37.36 PM.png',
		        //'img/Screen Shot 2019-06-28 at 2.14.59 PM.png',
				//'img/equirect.png',
		        (tex) => {

				    threepeat((scene, camera, renderer) => {

						const pmremGenerator = new THREE.PMREMGenerator( renderer );
						var hdrCubeRenderTarget = pmremGenerator.fromEquirectangular( tex );
						tex.dispose();
						pmremGenerator.dispose();

						scene.background = hdrCubeRenderTarget.texture;

						//sky(tex);

						let tf = new Curves.TrefoilKnot(30);
						let kc = new Curves.KnotCurve(30);

						var parent = new THREE.Object3D();
						scene.add( parent );

						var wrm = new Wrm(
							'teapot3',
							makecrv(function ( t, optionalTarget ) {

								var point = optionalTarget || new THREE.Vector3();

								t = 2 * Math.PI * t;

								var x = - 0.22 * Math.cos( t ) - 1.28 * Math.sin( t ) - 0.44 * Math.cos( 3 * t ) - 0.78 * Math.sin( 3 * t );
								var y = - 0.1 * Math.cos( 2 * t ) - 0.27 * Math.sin( 2 * t ) + 0.38 * Math.cos( 4 * t ) + 0.46 * Math.sin( 4 * t );
								var z = 0.7 * Math.cos( 3 * t ) - 0.4 * Math.sin( 3 * t );

								return point.set( x, y, z ).multiplyScalar( 60 );
							}),
							120
						);

						var seq = new Seq([
							[ 1, orbits[0], 1 ],
							[ 1, orbits[1], 1 ],
							[ 1, orbits[2], 1 ],
							[ 1, orbits[3], 1 ],
							[ 1, orbits[4], 1 ]
						]);

						//makemodel('teapot3', (tea) => { scene.add(tea) });

				        camera.position.z = 300;

				        return (t, ms) => {
							wrm.update(t);
							seq.update();
				        }
				    });
				});
		</script>
	</body>
</html>
